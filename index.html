<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="description" content="New Orleans Flood Analysis" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport"
    content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>New Orleans Flood Analysis</title>
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">

  <link rel="stylesheet" href="css/main.css">
  <script src="https://unpkg.com/scrollama"></script>
  <script
    src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>
</head>

<body>

  <section id="cover"
    style="background: url('https://19thnews.org/wp-content/uploads/2021/10/louisiana-hurricane_2jpg.jpg') no-repeat center center;  background-size: cover;">

    <div id="intro">
      <h1>New Orleans Flood Analysis</h1>
      <h4>About New Orleans</h4>
      <p style="text-align: center;">
        New Orleans, Lousianana is without a doubt one of the most famous US cities, known best for
        its exuberant carnival season,
        specifically it's city-wide celebration of Mardi Gras. But New Orleans
        is also famous for another reason: the many tropical hurricanes that
        batter the city and more notably, the widespread destruction that can
        accompany them.<br><br>New Orleans is located just off of the
        Gulf of Mexico, a tropical storm generating body of water. The high winds and low-pressure weather
        systems that accompany these storms cause tidal levels to rise and waves
        to form, resulting in a phenomena known as storm surge that causes
        violent flooding in low elevation coastal areas.<br><br>As a response
        to these conditions, New Orleans
        has overtime constructed levees surrounding the city to protect from the
        rising tides and flooding. Additionally, the city employs 23 pump
        stations that pump rainwater runoff and floodwater into the surrounding water bodies. 
        Unfortunately, this system hasn't always been successful.
        
      </p>

      <h4>About the Project</h4>
      <p style="text-align: center;">
        Using our skills as cartographers, we aim to examine the city and the
        risk
        posed by future hurricanes to provide a tool for potential damage
        mitigation and emergency response development.
        With the onset of global warming causing more extreme weather events
        around the world, it becomes increasingly important to equip cities like
        New Orleans with tools to mitigate and respond to these natural
        disasters which may become more frequent and intense with time.
      </p>
      <h5 style="text-align: center;">Team Members</h5>
      <div
        style="display: flex; flex-direction: row; justify-content: space-between;">
        <div id="bio">
          <img id="about"
            src='https://avatars.githubusercontent.com/u/59899413?v=4' /></img>
          <h6>
            Ajaz Syed <br><br> Senior in Geography</h6>
        </div>
        <div id="bio">
          <img id="about"
            src='https://avatars.githubusercontent.com/u/43830158?v=4' /></img>
          <h6>
            Maxwell Jayne <br><br> Senior in Geography</h6>
        </div>

        <div id="bio">
          <img id="about"
            src='https://avatars.githubusercontent.com/u/59627538?v=4' /></img>
          <h6>
            Emeka Emeche <br><br> Senior in Geography</h6>
        </div>
        <div id="bio">
          <img id="about"
            src='https://avatars.githubusercontent.com/u/102634353?v=4' /></img>
          <h6>
            Alyssa Havens <br><br> Student in Geography</h6>
        </div>
        <div id="bio">
          <img id="about"
            src='https://avatars.githubusercontent.com/u/75300297?v=4' /></img>
          <h6>
            Lee David <br><br> Senior in Geography</h6>
        </div>

      </div>




    </div>
  </section>

  <section id="damage_section">
    <div id="intro2">
      <h1>Hurricane Damage</h1>
      <div id="chunks">
        <p style="font-size: 25px; text-align: center;">Hurricane Katrina (2005)
        </p>

        <p style="font-size: 20px;">
          In 2005, the city was hit by Hurricane Katrina, a large
          category 3 hurricane. When Katrina made landfall on New Orleans, it
          flooded 80% of the city within 24 hours, up to 30 feet above sea level
          in some areas, by overtopping levees and subsequently eroding the
          ground
          beneath on the backside. <br>
        </p>
        <img id="chuck_img" src='img/KatrinaBefore.png'
          alt='Hurricane Katrina Before Image' /></img>
        <img id="chuck_img" src='img/KatrinaAfter.png'
          alt='Hurricane Katrina After Image' /></img>
      </div>
      <br>
      <div id="chunks">
        <p style="font-size: 25px; text-align: center;">Hurricane Ida (2021)
        </p>

        <p style="font-size: 20px;">

          In 2021, New Orleans was hit by Hurricane Ida, another massive
          hurricane similar in nature to Katrina.
          And as you can see the damage is similar after 16 years.
          These are two
          of the most devastating hurricanes that have hit New Orleans, and the
          city has been hit by many more, all causing flooding.

        </p>
        <img id="chuck_img2" src='img/IdaBefore.png'
          alt='Hurricane Ida Before Image' /></img>
        <img id="chuck_img2" src='img/IdaAfter.png'
          alt='Hurricane Ida After Image' /></img>

      </div>
      <div class="footnote">
        <span> Image attribution links <br></span><br>
        <a target="_blank"
          href="https://weather.com/storms/hurricane/news/2021-08-31-hurricane-ida-aerial-images-before-and-after">Hurricane
          Ida Images</a><br>
        <a target="_blank"
          href="https://globalnews.ca/news/2190704/hurricane-katrina-before-and-after-photos-show-rebuilt-neighbourhoods/">Hurricane
          Katrina Images</a>

      </div>

    </div>

  </section>


  <!-- a geonarrative will have two major components, a storyboard and a script panel of a series of scenes/actions -->
  <section id="geonarrative">
    <div id="storyboard">
      <!-- create the place holder element for map -->
      <nav id="menu"></nav>

      <div id="map"></div>

      <div class="map-overlay" id="legend"></div>

    </div>

    <article class="scene" data-scene="0">
      <h2>What happens in an emergency?</h2>

      <p>
        If a hurricane is near, the city has developed a timeline of steps
        to take to help residents evacuate or bunker down and get shelter.
      </p>

      <img id="items2"
        src='http://midcitymessenger.com/wp-content/uploads/2018/05/evacuation-timeline.png'
        alt='72-hour Evacuation Timeline' /></img>
      <h5>72-hour Evacuation Timeline</h5>

      <p>
        For the plan, the city has laid out various pick up points and safety
        shelters
        that can be used for residents to stay in and protect themselves against
        the hurricane.
        These spots are laid out across the city but majority of them are in
        more populated areas.
        The two major spots are the Mercedes-Benz Stadium and Smoothie King
        Center.
      </p>

    </article>
    <article class="scene" data-scene="1">
      <h2>Demographics Comparison</h2>

      <h5> Population By Block (2020)</h5>
      <p>
        We can see that areas along the coast of New Orleans consist of a higher
        volume of residents.
        This is common in most cities along water. Now the unfortunate part is
        that these areas are easier to
        be hit since they are along the coast.
      </p>
      <h5> Average Income By Block (2019)</h5>
      <p>
        Areas that are south of the coast have a higher income, this might be
        because it is safer and nicer.
        Whereas areas along the coast, have more people of various incomes,
        which make the average less.
      </p>

      <p>
        Areas with a smaller average income, have residents who are less likely
        to get up and leave their home
        everytime a major hurricane hits the city. These areas should be the
        focus for the New Orleans preventative measures.
      </p>
    </article>
    <article class="scene" data-scene="2">
      <h2>Flood Risk</h2>
      <h5>Risk Zone Development</h5>
      <p>Before Hurricane
        Katrina devastated New Orleans, city models estimated flood
        levels could reach up to 18 feet (5.5m) above sea level, and afterwards
        it was proven they could reach up to 30 feet (9.1m) above. <br>
</p>
      <p style="font-size: 14px; padding-right: 2rem;">

         <b>Low risk</b> plots
        are designated as those above 9m where the highest Katrina floodwaters were unable to touch and likely have not been damaged
        due to past flooding, but could be damaged by even larger future storms.
        <br>        <br>

        <b>Moderate</b>
        plots lower than 9m above sea level are designated where it has been proven possible flood damage can
        occur via Katrina's record flood levels, but is unlikely without a significantly large storm.
        <br>        <br>

        <b>High risk</b>
        plots lower than 4m above sea level are designated where it is almost certain that damage will occur if the levees are overtopped, and damage
        is likely from typical flooding events.
        <br>        <br>

        <b>Severe risk</b>
        plots designated as those within 1m of sea level, where any nearby flooding will cause damage,
        even if floodwaters are not able to fully overtop levees.
  </p>

      <p>

      </p>

    </article>
    <article class="scene" data-scene="3">
      <h2>Current Situation</h2>

      <h5>Wetlands Erosion</h5>
      <p>
        Lousisana, more specifically New Orleans, has seen a lot of beach
        erosion as well as wetlands shrinking over the past century. This leads
        to additional flooding to the city as it is easier for excess water to
        encroach the land and no place to go with limited wetlands.
      </p>


      <h5>Hurricane Damage Risk Reduction Plan</h5>
      <p>
        This year, New Orleans completed a $14.5 billion
        storm drain risk reduction program. This consists of new floodwalls and
        levees, as well as floodgates, surge barriers, and pump stations. This
        covers from the east to the west as well as Algiers Canal.
        The map shows only a rough outline of the current levees and floodwalls
        structure,
        but in terms of a solution this is only temporary.
      </p>




    </article>


  </section>

  <section id="footer">
    <h2>Conclusion</h2>
    <div id="footer_txt">

      <div>
        <img id="items"
          src='https://upload.wikimedia.org/wikipedia/commons/thumb/b/b2/New_Orleans_Elevations.jpg/1920px-New_Orleans_Elevations.jpg' /></img><br>
        <div class="footnote3">

          <a target="_blank"
            href="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b2/New_Orleans_Elevations.jpg/1920px-New_Orleans_Elevations.jpg">From
            Wikimedia</a>
        </div>
      </div>

      <div>
        <h2>People may wonder why anyone would build a city on ground that is
          below sea level? </h2>
        <p>
          Well initially it wasn’t.
          <br> <br>

          The sediment carried along the Mississippi river was deposited into
          the
          gulf and over time the sediment just piled up and formed a new land,
          which is
          New Orleans.
          <br> <br>

          As New Orleans population grew, so did the demand for land, so
          engineers
          essentially made drains to pump out the water in the swamplands, which
          in return dried the land so that people could live on it, but it
          removed
          water below the surface which caused air pockets and the soil at the
          surface started sinking to fill those air pockets.

          <br>
          <br>
          The pumps that help New Orleans from filling up with water take
          sediment out of the ground with the water.
          Normally, the sediment would continually be replaced by the flooding
          Mississippi River.<br>
          However, humans have stopped the sediment deposit process by:<br>
          1) Building dams upriver that trap sediment<br>
          2) Building walls around the river to keep it from flooding and
          depositing more sediment.
          <br>










        </p>

      </div>
    </div>
    <p style="  text-align: center; font-size: 22px; margin-top: 3rem; margin-left: 2rem; margin-right: 2rem; ">
      They should focus on the restoration of the wetlands and use natural
      cushions to prevent the flooding, especially along the coast.<br>


    </p>





  </section>


  <script>

    let map, scriptPanel = scrollama();


    history.scrollRestoration = "manual";
    window.scrollTo(0, 0);
    adjustStoryboardlSize();
    window.addEventListener("resize", adjustStoryboardlSize);

    function adjustStoryboardlSize() {

      const scenes = document.getElementsByClassName("scene");
      const storyboard = document.getElementById("storyboard");

      let sceneH = Math.floor(window.innerHeight * 0.75);
      for (const scene of scenes) {
        scene.style.height = sceneH + "px";
      }

      let storyboardHeight = window.innerHeight;
      let storyboardMarginTop = (window.innerHeight - storyboardHeight) / 2;

      storyboard.style.height = storyboardHeight + "px";
      storyboard.style.top = storyboardMarginTop + "px"

      scriptPanel.resize();
    }

    mapboxgl.accessToken =
      'pk.eyJ1IjoiYWphemtzeWVkIiwiYSI6ImNrd3plcWVsaTA0azkybm1wZ3c5MnB1OGcifQ.91la4ZENVFAgHfVaXoKjOw'; // Assign the access token

    map = new mapboxgl.Map({
      container: 'map', // container ID
      style: 'mapbox://styles/mapbox/light-v10',
      zoom: 10.77, // starting zoom
      minZoom: 3,
      maxZoom: 18,
      center: [-90.132, 29.994], // starting center
      scrollZoom: false,
      boxZoom: false,
      doubleClickZoom: true
    });
    map.addControl(new mapboxgl.NavigationControl());



    async function geojsonFetch() {

      let response, population20, income19, evac_spots, leeves;

      response = await fetch("assets/income(2019).geojson");
      income19 = await response.json();

      response = await fetch("assets/levees_lines.geojson");
      levees = await response.json();


      response = await fetch("assets/population(2020).geojson");
      population20 = await response.json();


      response = await fetch("assets/evacuation.geojson");
      evac_spots = await response.json();


      map.on('load', () => {

        map.addSource('income19-src', {
          type: 'geojson',
          data: income19,
          attribution: 'Layer designed by Ajaz Syed'

        });


        map.addSource('levees-src', {
          type: 'geojson',
          data: levees,
          attribution: 'Layer created and designed by Ajaz Syed'

        });

        map.addSource('population20-src', {
          type: 'geojson',
          data: population20,
          attribution: 'Layer designed by Ajaz Syed'

        });

        map.addSource('riskmap-src', {
          'type': 'raster',
          'tiles': [
            'assets/tiles/riskmap_final/{z}/{x}/{y}.png'
          ],
          'tileSize': 256,
          'attribution': 'Map tiles designed by Max Jayne'
        });

        map.loadImage(
          'img/shelter_icon.png',
          (error, image) => {
            if (error) throw error;
            map.addImage('custom-marker', image);
            // Add a GeoJSON source with 2 points
            map.addSource('evac-src', {
              type: 'geojson',
              data: evac_spots,
              attribution: 'Layer created and designed by Ajaz Syed'

            });
          });

        leveeLayer = {
          'id': 'levees_points',
          'type': 'line',
          'source': 'levees-src',
          'paint': {
            'line-width': 3,

            'line-color': ['get', 'color']
          }

        };

        evacLayer = {
          'id': 'evac_points',
          'type': 'symbol',
          'source': 'evac-src',
          'layout': {
            'icon-image': 'custom-marker',

          }
        };


        population20Layer = {
          'id': 'Population',
          'type': 'fill',
          'source': 'population20-src',
          'layout': {
            'visibility': 'visible'
          },
          paint: {
            'fill-color': [
              'step',
              ['get', 'population'],
              '#ffffb2',
              1000,
              '#ffd76d',
              2000,
              '#fea649',
              3000,
              '#f86c30',
              4000,
              '#e62f21',
              5000,
              '#bd0026',

            ],
            'fill-outline-color': '#BBBBBB',
          },

        };


        income19Layer = {
          'id': 'Income',
          'type': 'fill',
          'source': 'income19-src',
          'layout': {
            'visibility': 'visible'
          },
          paint: {
            'fill-color': [
              'step',
              ['get', 'income'],
              '#f7fcf5',
              10,
              '#ddf2d7',
              10000,
              '#b2e0ab',
              32000,
              '#7bc87c',
              56000,
              '#3da75a',
              87000,
              '#137e3a',
              125000,
              '#00441b',

            ],
            'fill-outline-color': '#BBBBBB',
          },

        };

        riskLayer = {
          'id': 'risk-plots',
          'type': 'raster',
          'source': 'riskmap-src'
        };

        scriptPanel
          .setup({
            step: ".scene", // all the scenes.
            offset: 0.4, // the location of the enter and exit trigger
            debug: false
          })
          .onStepEnter(handleSceneEnter)
          .onStepExit(handleSceneExit);

        function handleSceneEnter(response) {

          var index = response.index; // capture the id of the current scene.
          document.getElementById("legend").style.visibility = "hidden";

          if (index === 0) { // When enter the first scene

            map.flyTo({

              center: [-90.103, 29.971],
              zoom: 11.77,
              pitch: 0,
            });

            if (typeof (map.getSource('evac-src')) == 'undefined') {
              map.addSource('evac-src', {
                type: 'geojson',
                data: evac_spots,
                attribution: 'Layer created and designed by Ajaz Syed'
              });
            } else {
              map.getSource('evac-src')

            }

            if (!map.getLayer("evac_points")) {
              map.addLayer(evacLayer);
            }


            document.getElementById("damage_section").style.visibility = "hidden"; // Hide the cover page

            document.getElementById("cover").style.visibility = "hidden"; // Hide the cover page

          } else if (index === 1) { // When enter the second scene.


            map.flyTo({
              center: [-90.078, 30.018],
              zoom: 10.3, // starting zoom
              pitch: 0,
            });
            const pop_layers = [
              '<1000',
              '1000-1999',
              '2000-2999',
              '3000-3999',
              '4000-4999',
              '5000+'
            ];

            const pop_colors = [
              '#ffffb2',
              '#ffd76d',
              '#fea649',
              '#f86c30',
              '#e62f21',
              '#bd0026'
            ];


            const inc_layers = [
              'No data',
              '<$10,000',
              '$10,000 - $31,999',
              '$32,000 - $55,999',
              '$56,000 - $86,999',
              '$87,000 - $124,999',
              '$125,000+'
            ];

            const inc_colors = [
              '#f7fcf5',
              '#ddf2d7',
              '#b2e0ab',
              '#7bc87c',
              '#3da75a',
              '#137e3a',
              '#00441b'
            ];
            map.addLayer(population20Layer);
            map.addLayer(income19Layer);

            document.getElementById("menu").style.visibility = "visible";
            if (!map.getLayer('Population') || !map.getLayer('Income')) {
              return;
            }

            const toggleableLayerIds = ['Population', 'Income'];

            for (const id of toggleableLayerIds) {
              if (document.getElementById(id)) {
                continue;
              }
              const link = document.createElement('a');
              link.id = id;
              link.href = '#';
              link.textContent = id;
              link.className = 'active';

              // Show or hide layer when the toggle is clicked.
              link.onclick = function (e) {
                const clickedLayer = this.textContent;
                e.preventDefault();
                e.stopPropagation();

                const visibility = map.getLayoutProperty(
                  clickedLayer,
                  'visibility'
                );

                // Toggle layer visibility by changing the layout object's visibility property.
                if (visibility === 'visible') {
                  map.setLayoutProperty(clickedLayer, 'visibility', 'none');

                  this.className = '';
                } else {
                  this.className = 'active';
                  map.setLayoutProperty(
                    clickedLayer,
                    'visibility',
                    'visible'
                  );
                  if (clickedLayer == 'Population') {
                    document.getElementById("legend").style.visibility = "visible";

                    const legend = document.getElementById("legend");
                    legend.innerHTML = "<b>Population (2020)</b><br><br>";


                    pop_layers.forEach((layer, i) => {
                      const color = pop_colors[i];
                      const item = document.createElement('div');
                      const key = document.createElement('span');
                      key.className = 'legend-key';
                      key.style.backgroundColor = color;

                      const value = document.createElement('span');
                      value.innerHTML = `${layer}`;
                      item.appendChild(key);
                      item.appendChild(value);
                      legend.appendChild(item);
                    });
                  } else {
                    document.getElementById("legend").style.visibility = "visible";

                    const legend = document.getElementById("legend");
                    legend.innerHTML = "<b>Average Household Income (2019)</b><br><br>";


                    inc_layers.forEach((layer, i) => {
                      const color = inc_colors[i];
                      const item = document.createElement('div');
                      const key = document.createElement('span');
                      key.className = 'legend-key';
                      key.style.backgroundColor = color;

                      const value = document.createElement('span');
                      value.innerHTML = `${layer}`;
                      item.appendChild(key);
                      item.appendChild(value);
                      legend.appendChild(item);
                    });
                  }
                }


              };

              const layers = document.getElementById('menu');
              layers.appendChild(link);
            }



          } else if (index === 2) {
            map.flyTo({
              center: [-90.096, 29.992],
              zoom: 11.72,
            });
            const risk_layers = [
              'Severe (<=1m above sea level)',
              'High (<=4m above sea level)',
              'Moderate (<=9m above sea level)',
              'Low (>9m above sea level)'
            ];

            const risk_colors = [
              '#ff4901',
              '#ffaf01',
              '#ffea01',
              '#19fe00'
            ];

            if (typeof (map.getSource('riskmap-src')) == 'undefined') {
              map.addSource('riskmap-src', {
                type: 'raster',
              });
            } else {
              map.getSource('riskmap-src')

            }

            if (!map.getLayer("risk-plots")) {
              map.addLayer(riskLayer);
            }

            document.getElementById("legend").style.visibility = "visible";

            const legend = document.getElementById("legend");
            legend.innerHTML = "<b>Risk Levels</b><br><br>";


            risk_layers.forEach((layer, i) => {
              const color = risk_colors[i];
              const item = document.createElement('div');
              const key = document.createElement('span');
              key.className = 'legend-key';
              key.style.backgroundColor = color;

              const value = document.createElement('span');
              value.innerHTML = `${layer}`;
              item.appendChild(key);
              item.appendChild(value);
              legend.appendChild(item);
            });

          } else if (index === 3) {
            map.flyTo({
              center: [-90.136, 30.007],
              zoom: 10.62,
            });
            const layer = [
              'Greater New Orleans Hurricane Damage Risk Reduction System',
              'Flood walls',
              'Sunken Levees',
              'Mississippi River Levees'
            ];

            const colors = [
              '#FAA916',
              '#044167',
              '#ED3731',
              '#193C16'
            ];
            if (typeof (map.getSource('levees-src')) == 'undefined') {
              map.addSource('levees-src', {
                type: 'geojson',
                data: levees,
                attribution: 'Layer created and designed by Ajaz Syed'
              });
            } else {
              map.getSource('levees-src')

            }

            if (!map.getLayer("levees_points")) {
              map.addLayer(leveeLayer);
            }

            document.getElementById("legend").style.visibility = "visible";

            const legend = document.getElementById("legend");
            legend.innerHTML = "<b>Very Rough Outline of New Orleans' Current Levees</b><br><br>";


            layer.forEach((layer, i) => {
              const color = colors[i];
              const item = document.createElement('div');
              const key = document.createElement('span');
              key.className = 'legend-key';
              key.style.backgroundColor = color;
              const value = document.createElement('span');
              value.innerHTML = `${layer}`;
              item.appendChild(key);
              item.appendChild(value);
              legend.appendChild(item);
            });


          }
        }

        function handleSceneExit(response) {
          var index = response.index;

          if (index === 0) {

            if (response.direction == 'down') {
              document.getElementById("cover").style.visibility = "hidden";
              document.getElementById("damage_section").style.visibility = "hidden";

            } else {
              document.getElementById("cover").style.visibility = "visible";
              document.getElementById("damage_section").style.visibility = "visible";

            }
            if (map.getLayer("evac_points")) {
              map.removeLayer('evac_points');
            }
          } else if (index === 1) {
            if (map.getLayer("Population")) {
              map.removeLayer('Population');
            }
            if (map.getLayer("Income")) {
              map.removeLayer('Income');

            }
            document.getElementById("menu").style.visibility = "hidden";

          } else if (index === 2) {

            if (map.getLayer("risk-plots")) {
              map.removeLayer('risk-plots');
            }
          } else if (index === 3) {
            if (map.getLayer("levees_points")) {
              map.removeLayer('levees_points');
            }
          }
        }


      });

    };
    geojsonFetch();
  </script>
</body>

</html>
